<!DOCTYPE html>
<html>
  <head>
    <title>Star Engine</title>
    <meta charset="utf-8">
    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height"/>

    <script type="text/javascript" src="../starengine.min.js"></script>
    <script type="text/javascript">
        window.onload = function(){
            var game = new se.StarEngine('canvas');

            var scene = new se.Scene();
            game.addScene(scene);

            var ground = new se.GameObject('ground', -1500, 250, 2800, 450);
            ground.addCollider( new se.BoxCollider(0, 0, 2800, 200) );
            ground.setRenderer( new se.BoxRenderer('#6B4226') );
            scene.add(ground);

            var grass = new se.GameObject('grass', 0, 0, 2800, 10);
            grass.setRenderer( new se.BoxRenderer('green') );
            ground.addChild(grass);

            var wall1 = new se.GameObject('wall1', -1000, -100, 40, 360);
            wall1.addCollider( new se.BoxCollider(0, 0, 40, 370) );
            wall1.setRenderer( new se.BoxRenderer('#A68064') );
            scene.add(wall1);

            var ground2 = new se.GameObject('ground2', 1400, 250, 3000, 450);
            ground2.addCollider( new se.BoxCollider(0, 0, 3000, 200) );
            ground2.setRenderer( new se.BoxRenderer('#6B4226') );
            scene.add(ground2);

            var grass2 = new se.GameObject('grass2', 0, 0, 3000, 10);
            grass2.setRenderer( new se.BoxRenderer('green') );
            ground2.addChild(grass2);

            var box = new se.GameObject('box', 520, 170, 80, 80);
            box.addCollider( new se.BoxCollider(0, 0, 80, 80) );
            box.setRenderer( new se.ImageRenderer('box.jpg') );
            scene.add(box);

            var obj_player = new se.GameObject('Player', 20, 200, 0, 0);
            obj_player.addComponent( new se.ComponentPlatformPlayerController(game.joystick, 400, 400, 400) );
            obj_player.addCollider( new se.BoxCollider(-25, 0, 50, 50) );
            obj_player.setRenderer( new se.BoxRenderer('#dddddd') );
            scene.add(obj_player);

            var player_body = new se.GameObject('PlayerBody', -25, 0, 50, 50);
            player_body.setRenderer( new se.BoxRenderer('#dddddd') );
            obj_player.addChild(player_body);

            var player_eye = new se.GameObject('PlayerEye', 10, 10, 15, 10);
            player_eye.setRenderer( new se.BoxRenderer('blue') );
            obj_player.addChild(player_eye);

            scene.getCamera().addComponent( new se.ComponentFollowObject(obj_player));

            game.init();

            // Buttons
            // B1
            var b1 = document.getElementById('b1');
            var b1start = function(){
                game.joystick.setAxis('horizontal',-1);
            };
            b1.addEventListener('mousedown', b1start);
            b1.addEventListener('touchstart', b1start);
            var b1end   = function(){
                game.joystick.setAxis('horizontal',0);
            };
            b1.addEventListener('mouseup', b1end);
            b1.addEventListener('touchend', b1end);

            // B2
            var b2 = document.getElementById('b2');
            var b2start = function(){
                game.joystick.setAxis('horizontal',1);
            };
            b2.addEventListener('mousedown', b2start);
            b2.addEventListener('touchstart', b2start);
            var b2end   = function(){
                game.joystick.setAxis('horizontal',0);
            };
            b2.addEventListener('mouseup', b2end);
            b2.addEventListener('touchend', b1end);

            // B3
            var b3 = document.getElementById('b3');
            var b3start = function(){
                game.joystick.setAxis('jump',true);
            };
            b3.addEventListener('mousedown', b3start);
            b3.addEventListener('touchstart', b3start);
            var b3end   = function(){
                game.joystick.setAxis('jump',false);
            };
            b3.addEventListener('mouseup', b3end);
            b3.addEventListener('touchend', b3end);
        };
    </script>
    <style type="text/css">
        * {
            margin: 0;
            padding: 0;
        }
        body, html {
            overflow: hidden;
            width: 100%;
            height: 100%;
        }
        canvas { 
            border: 1px solid black; 
        }
        .se-joy-buttons{
            display: block;
            position: absolute;
            bottom: 40px;
        }
        .se-joy-buttons span{
            padding: 10px 20px;
            border: 1px solid black;
            background-color: #CCC;
            font-size: 37px;
        }
        #b1{
            left: 30px;
        }
        #b2{
            left: 100px;
        }
        #b3{
            right: 30px;
        }
        html {
            -webkit-user-select: none;
        }
    </style>
  </head>
  <body>
      <canvas id="canvas" width="600" height="600"></canvas>
      <div id="b1" class="se-joy-buttons">
          <span href="#"> < </span>
      </div>
      <div id="b2" class="se-joy-buttons">
          <span href="#"> > </span>
      </div>
      <div id="b3" class="se-joy-buttons">
          <span href="#"> ^ </span>
      </div>
  </body>
</html>
